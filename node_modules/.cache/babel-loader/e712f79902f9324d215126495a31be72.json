{"ast":null,"code":"import _regeneratorRuntime from \"/Users/monica/Desktop/snack-training/template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/monica/Desktop/snack-training/template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/monica/Desktop/snack-training/template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/monica/Desktop/snack-training/template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/Users/monica/Desktop/snack-training/template/src/shared/components/auth/withAuth0.jsx\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport createAuth0Client from '@auth0/auth0-spa-js';\nexport var Auth0Context = React.createContext();\nexport var useAuth0 = function useAuth0() {\n  return useContext(Auth0Context);\n};\nexport function hookAuth0(WrappedComponent) {\n  return function HockComponent(props) {\n    var auth0 = useAuth0();\n    return React.createElement(WrappedComponent, Object.assign({}, props, {\n      auth0: auth0,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 11\n      },\n      __self: this\n    }));\n  };\n}\n\nvar Auth0Provider = function Auth0Provider(_ref) {\n  var children = _ref.children,\n      onRedirectCallback = _ref.onRedirectCallback,\n      initOptions = _objectWithoutProperties(_ref, [\"children\", \"onRedirectCallback\"]);\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      isAuthenticated = _useState2[0],\n      setIsAuthenticated = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      user = _useState4[0],\n      setUser = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      auth0Client = _useState6[0],\n      setAuth0 = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      popupOpen = _useState10[0],\n      setPopupOpen = _useState10[1];\n\n  useEffect(function () {\n    var initAuth0 =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var auth0FromHook, _ref3, appState, isAuth, currentUser;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return createAuth0Client(initOptions);\n\n              case 2:\n                auth0FromHook = _context.sent;\n                setAuth0(auth0FromHook);\n\n                if (!window.location.search.includes('code=')) {\n                  _context.next = 10;\n                  break;\n                }\n\n                _context.next = 7;\n                return auth0FromHook.handleRedirectCallback();\n\n              case 7:\n                _ref3 = _context.sent;\n                appState = _ref3.appState;\n                onRedirectCallback(appState);\n\n              case 10:\n                _context.next = 12;\n                return auth0FromHook.isAuthenticated();\n\n              case 12:\n                isAuth = _context.sent;\n                setIsAuthenticated(isAuth);\n\n                if (!isAuth) {\n                  _context.next = 19;\n                  break;\n                }\n\n                _context.next = 17;\n                return auth0FromHook.getUser();\n\n              case 17:\n                currentUser = _context.sent;\n                setUser(currentUser);\n\n              case 19:\n                setLoading(false);\n\n              case 20:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function initAuth0() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    initAuth0(); // eslint-disable-next-line\n  }, []);\n\n  var loginWithPopup =\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var params,\n          currentUser,\n          _args2 = arguments;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              params = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : {};\n              setPopupOpen(true);\n              _context2.prev = 2;\n              _context2.next = 5;\n              return auth0Client.loginWithPopup(params);\n\n            case 5:\n              _context2.next = 10;\n              break;\n\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](2);\n              // eslint-disable-next-line\n              console.error(_context2.t0);\n\n            case 10:\n              _context2.prev = 10;\n              setPopupOpen(false);\n              return _context2.finish(10);\n\n            case 13:\n              _context2.next = 15;\n              return auth0Client.getUser();\n\n            case 15:\n              currentUser = _context2.sent;\n              setUser(currentUser);\n              setIsAuthenticated(true);\n\n            case 18:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[2, 7, 10, 13]]);\n    }));\n\n    return function loginWithPopup() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var handleRedirectCallback =\n  /*#__PURE__*/\n  function () {\n    var _ref5 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3() {\n      var currentUser;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setLoading(true);\n              _context3.next = 3;\n              return auth0Client.handleRedirectCallback();\n\n            case 3:\n              _context3.next = 5;\n              return auth0Client.getUser();\n\n            case 5:\n              currentUser = _context3.sent;\n              setLoading(false);\n              setIsAuthenticated(true);\n              setUser(currentUser);\n\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleRedirectCallback() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(Auth0Context.Provider, {\n    value: {\n      isAuthenticated: isAuthenticated,\n      user: user,\n      loading: loading,\n      popupOpen: popupOpen,\n      loginWithPopup: loginWithPopup,\n      handleRedirectCallback: handleRedirectCallback,\n      getIdTokenClaims: function getIdTokenClaims() {\n        return auth0Client.getIdTokenClaims.apply(auth0Client, arguments);\n      },\n      loginWithRedirect: function loginWithRedirect() {\n        return auth0Client.loginWithRedirect.apply(auth0Client, arguments);\n      },\n      getTokenSilently: function getTokenSilently() {\n        return auth0Client.getTokenSilently.apply(auth0Client, arguments);\n      },\n      getTokenWithPopup: function getTokenWithPopup() {\n        return auth0Client.getTokenWithPopup.apply(auth0Client, arguments);\n      },\n      logout: function logout() {\n        return auth0Client.logout.apply(auth0Client, arguments);\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, children);\n};\n\nAuth0Provider.propTypes = {\n  children: PropTypes.node.isRequired,\n  onRedirectCallback: PropTypes.func\n};\nAuth0Provider.defaultProps = {\n  onRedirectCallback: function onRedirectCallback() {\n    return window.history.replaceState({}, document.title, window.location.pathname);\n  }\n};\nexport default Auth0Provider;","map":{"version":3,"sources":["/Users/monica/Desktop/snack-training/template/src/shared/components/auth/withAuth0.jsx"],"names":["React","useState","useEffect","useContext","PropTypes","createAuth0Client","Auth0Context","createContext","useAuth0","hookAuth0","WrappedComponent","HockComponent","props","auth0","Auth0Provider","children","onRedirectCallback","initOptions","isAuthenticated","setIsAuthenticated","user","setUser","auth0Client","setAuth0","loading","setLoading","popupOpen","setPopupOpen","initAuth0","auth0FromHook","window","location","search","includes","handleRedirectCallback","appState","isAuth","getUser","currentUser","loginWithPopup","params","console","error","getIdTokenClaims","loginWithRedirect","getTokenSilently","getTokenWithPopup","logout","propTypes","node","isRequired","func","defaultProps","history","replaceState","document","title","pathname"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport createAuth0Client from '@auth0/auth0-spa-js';\n\nexport const Auth0Context = React.createContext();\nexport const useAuth0 = () => useContext(Auth0Context);\n\nexport function hookAuth0(WrappedComponent) {\n  return function HockComponent(props) {\n    const auth0 = useAuth0();\n    return <WrappedComponent {...props} auth0={auth0} />;\n  };\n}\n\nconst Auth0Provider = ({\n  children,\n  onRedirectCallback,\n  ...initOptions\n}) => {\n  const [isAuthenticated, setIsAuthenticated] = useState();\n  const [user, setUser] = useState();\n  const [auth0Client, setAuth0] = useState();\n  const [loading, setLoading] = useState(true);\n  const [popupOpen, setPopupOpen] = useState(false);\n\n  useEffect(() => {\n    const initAuth0 = async () => {\n      const auth0FromHook = await createAuth0Client(initOptions);\n      setAuth0(auth0FromHook);\n\n      if (window.location.search.includes('code=')) {\n        const { appState } = await auth0FromHook.handleRedirectCallback();\n        onRedirectCallback(appState);\n      }\n\n      const isAuth = await auth0FromHook.isAuthenticated();\n\n      setIsAuthenticated(isAuth);\n\n      if (isAuth) {\n        const currentUser = await auth0FromHook.getUser();\n        setUser(currentUser);\n      }\n\n      setLoading(false);\n    };\n    initAuth0();\n    // eslint-disable-next-line\n  }, []);\n\n  const loginWithPopup = async (params = {}) => {\n    setPopupOpen(true);\n    try {\n      await auth0Client.loginWithPopup(params);\n    } catch (error) {\n      // eslint-disable-next-line\n      console.error(error);\n    } finally {\n      setPopupOpen(false);\n    }\n    const currentUser = await auth0Client.getUser();\n    setUser(currentUser);\n    setIsAuthenticated(true);\n  };\n\n  const handleRedirectCallback = async () => {\n    setLoading(true);\n    await auth0Client.handleRedirectCallback();\n    const currentUser = await auth0Client.getUser();\n    setLoading(false);\n    setIsAuthenticated(true);\n    setUser(currentUser);\n  };\n  return (\n    <Auth0Context.Provider\n      value={{\n        isAuthenticated,\n        user,\n        loading,\n        popupOpen,\n        loginWithPopup,\n        handleRedirectCallback,\n        getIdTokenClaims: (...p) => auth0Client.getIdTokenClaims(...p),\n        loginWithRedirect: (...p) => auth0Client.loginWithRedirect(...p),\n        getTokenSilently: (...p) => auth0Client.getTokenSilently(...p),\n        getTokenWithPopup: (...p) => auth0Client.getTokenWithPopup(...p),\n        logout: (...p) => auth0Client.logout(...p),\n      }}\n    >\n      {children}\n    </Auth0Context.Provider>\n  );\n};\n\nAuth0Provider.propTypes = {\n  children: PropTypes.node.isRequired,\n  onRedirectCallback: PropTypes.func,\n};\n\nAuth0Provider.defaultProps = {\n  onRedirectCallback: () => window.history.replaceState({}, document.title, window.location.pathname),\n};\n\nexport default Auth0Provider;\n"]},"metadata":{},"sourceType":"module"}